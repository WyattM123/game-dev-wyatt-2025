<script>

let myScore = 10
let myGun01
let myGun02
let myShooting = 1

// NEW: remembers last direction you moved
let lastDirection = "right"


// =======================
// COLLISION DETECTION
// =======================
function myHitOther(my1, my2){
   let A = document.getElementById(my1).getBoundingClientRect()
   let B = document.getElementById(my2).getBoundingClientRect()

   return !(
      A.right < B.left ||
      A.left > B.right ||
      A.bottom < B.top ||
      A.top > B.bottom
   )
}


// =======================
// CHECK HIT
// =======================
function myCheckHit(){

   if (myHitOther('myBullet01','myImg02')){
      document.all.myText01.value = "You shot Zombie1!"
      clearInterval(myGun01)
      document.getElementById('myBullet01').style.left = '-200px'
      myScore += 1
   }

   if (myHitOther('myBullet02','myImg02')){
      document.all.myText01.value = "You shot Zombie1!"
      clearInterval(myGun02)
      document.getElementById('myBullet02').style.left = '-200px'
      myScore += 1
   }

   if (myHitOther('myBullet01','myImg03')){
      document.all.myText01.value = "You shot Zombie2!"
      clearInterval(myGun01)
      document.getElementById('myBullet01').style.left = '-200px'
      myScore += 1
   }

   if (myHitOther('myBullet02','myImg03')){
      document.all.myText01.value = "You shot Zombie2!"
      clearInterval(myGun02)
      document.getElementById('myBullet02').style.left = '-200px'
      myScore += 1
   }
}


// =======================
// MOVEMENT
// =======================
function moveUp(){
   lastDirection = "up"
   let g = document.getElementById('myImg01')
   g.style.top = parseInt(g.style.top) - 10 + 'px'
}

function moveDown(){
   lastDirection = "down"
   let g = document.getElementById('myImg01')
   g.style.top = parseInt(g.style.top) + 10 + 'px'
}

function moveLeft(){
   lastDirection = "left"
   let g = document.getElementById('myImg01')
   g.style.left = parseInt(g.style.left) - 10 + 'px'
}

function moveRight(){
   lastDirection = "right"
   let g = document.getElementById('myImg01')
   g.style.left = parseInt(g.style.left) + 10 + 'px'
}



// =======================
// SHOOT – Bullet moves based on last direction walked
// =======================
function fireBullet(){

   // alternate bullets (so they don’t freeze)
   if (myShooting > 2) myShooting = 1

   let bulletID = (myShooting == 1) ? "myBullet01" : "myBullet02"
   let intervalID = (myShooting == 1) ? "myGun01" : "myGun02"

   myShooting++

   let b = document.getElementById(bulletID)
   let g = document.getElementById('myImg01')

   // starting position
   b.style.left = parseInt(g.style.left) + 40 + 'px'
   b.style.top  = parseInt(g.style.top) + 30 + 'px'

   // clear previous bullet movement
   clearInterval(window[intervalID])

   // movement logic
   window[intervalID] = setInterval(function(){

      let x = parseInt(b.style.left)
      let y = parseInt(b.style.top)

      if (lastDirection == "right") x += 10
      if (lastDirection == "left")  x -= 10
      if (lastDirection == "up")    y -= 10
      if (lastDirection == "down")  y += 10

      b.style.left = x + "px"
      b.style.top = y + "px"

      myCheckHit()

   }, 20)
}

</script>


<body onkeydown="{
   if(event.key=='w') moveUp()
   if(event.key=='s') moveDown()
   if(event.key=='a') moveLeft()
   if(event.key=='d') moveRight()
}">


<input id="myText01" type=text size=30><br><br>

<button onclick="moveUp()">W</button><br>
<button onclick="moveLeft()">A</button>
<button onclick="moveDown()">S</button>
<button onclick="moveRight()">D</button><br><br>

<button onclick="fireBullet()">SHOOT</button><br><br>


<!-- PLAYER -->
<img id="myImg01" src="olddudewitgun.gif"
     style="position:absolute; width:100px; height:80px; left:50px; top:200px;">

<!-- ZOMBIES -->
<img id="myImg02" src="Zombie1.gif"
     style="position:absolute; width:100px; height:80px; left:350px; top:190px;">

<img id="myImg03" src="Zombie2.gif"
     style="position:absolute; width:100px; height:80px; left:500px; top:190px;">

<!-- BULLETS -->
<img id="myBullet01" src="Bullet1.gif"
     style="position:absolute; width:10px; height:10px; left:-200px; top:-200px; z-index:9999;">

<img id="myBullet02" src="Bullet1.gif"
     style="position:absolute; width:10px; height:10px; left:-200px; top:-200px; z-index:9999;">
